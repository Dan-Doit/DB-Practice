-- 동물 입양소

SELECT A.HOUR, NVL(B.COUNT,0) AS COUNT
FROM (SELECT LEVEL-1 AS HOUR,0 AS COUNT 
	FROM DUAL CONNECT BY LEVEL<25) A 
LEFT OUTER JOIN (SELECT TO_CHAR(DATETIME,'HH24') AS HOUR, COUNT(TO_CHAR(DATETIME,'HH24')) AS COUNT
	FROM ANIMAL_OUTS 
	GROUP BY TO_CHAR(DATETIME,'HH24')) B 
ON A.HOUR = B.HOUR
ORDER BY A.HOUR; 


-- 코드를 입력하세요
SELECT HOUR(DATETIME) AS HOUR, COUNT(HOUR(DATETIME)) AS COUNT
FROM ANIMAL_OUTS
WHERE HOUR(DATETIME) BETWEEN 9 AND 19
GROUP BY HOUR(DATETIME)
ORDER BY HOUR;


-- 코드를 입력하세요
SELECT B.ANIMAL_ID, B.NAME FROM ANIMAL_INS A, ANIMAL_OUTS B 
WHERE 1=1 
AND A.ANIMAL_ID(+) = B.ANIMAL_ID 
AND A.ANIMAL_ID IS NULL
ORDER BY B.ANIMAL_ID ASC;


SELECT A.ANIMAL_ID,A.NAME FROM ANIMAL_INS A
LEFT OUTER JOIN ANIMAL_OUTS B
ON A.ANIMAL_ID = B.ANIMAL_ID
WHERE A.DATETIME > B.DATETIME
ORDER BY A.DATETIME;

-- 코드를 입력하세요
SELECT ANIMAL_ID,NAME, TO_CHAR(DATETIME,'YYYY-MM-DD')AS 날짜 FROM ANIMAL_INS
ORDER BY ANIMAL_ID;
